function H_opt = calculateHamiltonian(in1,in2,in3,in4)
%CALCULATEHAMILTONIAN
%    H_OPT = CALCULATEHAMILTONIAN(IN1,IN2,IN3,IN4)

%    This function was generated by the Symbolic Math Toolbox version 8.7.
%    18-Oct-2021 10:22:28

pu1 = in3(1,:);
pu2 = in3(2,:);
pu3 = in3(3,:);
pu4 = in3(4,:);
pw1 = in4(1,:);
pw2 = in4(2,:);
pw3 = in4(3,:);
pw4 = in4(4,:);
u1 = in1(1,:);
u2 = in1(2,:);
u3 = in1(3,:);
u4 = in1(4,:);
w1 = in2(1,:);
w2 = in2(2,:);
w3 = in2(3,:);
w4 = in2(4,:);
t2 = u1.^2;
t3 = u1.^3;
t4 = u2.^2;
t6 = u2.^3;
t7 = u3.^2;
t9 = u3.^3;
t10 = u4.^2;
t12 = u4.^3;
t14 = w1.^2;
t15 = w1.^3;
t16 = w2.^2;
t17 = w2.^3;
t18 = w3.^2;
t19 = w3.^3;
t20 = w4.^2;
t21 = w4.^3;
t30 = sqrt(2.0);
t5 = t2.^2;
t8 = t4.^2;
t11 = t7.^2;
t13 = t10.^2;
t22 = t14.*2.0;
t23 = t16.*2.0;
t24 = t14.*4.0;
t25 = t18.*2.0;
t26 = t16.*4.0;
t27 = t20.*2.0;
t28 = t18.*4.0;
t29 = t20.*4.0;
t31 = t2./2.0;
t32 = t4./2.0;
t33 = t2./4.0;
t34 = t7./2.0;
t35 = t4./4.0;
t36 = t10./2.0;
t37 = t7./4.0;
t38 = t10./4.0;
t51 = pw1.*t12.*t30.*u1.*w4;
t52 = pw1.*t12.*t30.*u2.*w3;
t53 = pw1.*t12.*t30.*u3.*w2;
t54 = pw1.*t3.*t30.*u4.*w4;
t55 = pw1.*t6.*t30.*u4.*w3;
t56 = pw1.*t9.*t30.*u4.*w2;
t57 = pw2.*t9.*t30.*u1.*w4;
t58 = pw2.*t9.*t30.*u2.*w3;
t59 = pw2.*t12.*t30.*u3.*w1;
t60 = pw2.*t3.*t30.*u3.*w4;
t61 = pw2.*t6.*t30.*u3.*w3;
t62 = pw2.*t9.*t30.*u4.*w1;
t63 = pw3.*t6.*t30.*u1.*w4;
t64 = pw3.*t9.*t30.*u2.*w2;
t65 = pw3.*t12.*t30.*u2.*w1;
t66 = pw3.*t3.*t30.*u2.*w4;
t67 = pw3.*t6.*t30.*u3.*w2;
t68 = pw3.*t6.*t30.*u4.*w1;
t69 = pw4.*t6.*t30.*u1.*w3;
t70 = pw4.*t9.*t30.*u1.*w2;
t71 = pw4.*t12.*t30.*u1.*w1;
t72 = pw4.*t3.*t30.*u2.*w3;
t73 = pw4.*t3.*t30.*u3.*w2;
t74 = pw4.*t3.*t30.*u4.*w1;
t75 = pw1.*t2.*t30.*u2.*u4.*w3;
t76 = pw1.*t2.*t30.*u3.*u4.*w2;
t77 = pw2.*t2.*t30.*u2.*u3.*w3;
t78 = pw2.*t2.*t30.*u3.*u4.*w1;
t79 = pw3.*t2.*t30.*u2.*u3.*w2;
t80 = pw3.*t2.*t30.*u2.*u4.*w1;
t81 = pw1.*t4.*t30.*u1.*u4.*w4;
t82 = pw1.*t4.*t30.*u3.*u4.*w2;
t83 = pw2.*t4.*t30.*u1.*u3.*w4;
t84 = pw2.*t4.*t30.*u3.*u4.*w1;
t85 = pw4.*t4.*t30.*u1.*u3.*w2;
t86 = pw4.*t4.*t30.*u1.*u4.*w1;
t87 = pw1.*t7.*t30.*u1.*u4.*w4;
t88 = pw1.*t7.*t30.*u2.*u4.*w3;
t89 = pw3.*t7.*t30.*u1.*u2.*w4;
t90 = pw3.*t7.*t30.*u2.*u4.*w1;
t91 = pw4.*t7.*t30.*u1.*u2.*w3;
t92 = pw4.*t7.*t30.*u1.*u4.*w1;
t93 = pw2.*t10.*t30.*u1.*u3.*w4;
t94 = pw2.*t10.*t30.*u2.*u3.*w3;
t95 = pw3.*t10.*t30.*u1.*u2.*w4;
t96 = pw3.*t10.*t30.*u2.*u3.*w2;
t97 = pw4.*t10.*t30.*u1.*u2.*w3;
t98 = pw4.*t10.*t30.*u1.*u3.*w2;
t99 = t2+t4+t7+t10;
t100 = pw1.*t2.*t10.*t30.*w1;
t101 = pw1.*t4.*t10.*t30.*w1;
t102 = pw2.*t2.*t7.*t30.*w2;
t103 = pw1.*t7.*t10.*t30.*w1;
t104 = pw2.*t4.*t7.*t30.*w2;
t105 = pw3.*t2.*t4.*t30.*w3;
t106 = pw2.*t7.*t10.*t30.*w2;
t107 = pw3.*t4.*t7.*t30.*w3;
t108 = pw4.*t2.*t4.*t30.*w4;
t109 = pw3.*t4.*t10.*t30.*w3;
t110 = pw4.*t2.*t7.*t30.*w4;
t111 = pw4.*t2.*t10.*t30.*w4;
t112 = pw1.*t30.*u1.*u2.*w1.*w3.*w4.*8.0;
t113 = pw1.*t30.*u1.*u3.*w1.*w2.*w4.*8.0;
t114 = pw1.*t30.*u2.*u3.*w1.*w2.*w3.*8.0;
t115 = pw2.*t30.*u1.*u2.*w2.*w3.*w4.*8.0;
t116 = pw2.*t30.*u1.*u4.*w1.*w2.*w4.*8.0;
t117 = pw2.*t30.*u2.*u4.*w1.*w2.*w3.*8.0;
t118 = pw3.*t30.*u1.*u3.*w2.*w3.*w4.*8.0;
t119 = pw3.*t30.*u1.*u4.*w1.*w3.*w4.*8.0;
t120 = pw3.*t30.*u3.*u4.*w1.*w2.*w3.*8.0;
t121 = pw4.*t30.*u2.*u3.*w2.*w3.*w4.*8.0;
t122 = pw4.*t30.*u2.*u4.*w1.*w3.*w4.*8.0;
t123 = pw4.*t30.*u3.*u4.*w1.*w2.*w4.*8.0;
t124 = pw1.*t2.*t15.*t30.*4.0;
t125 = pw1.*t4.*t15.*t30.*4.0;
t126 = pw1.*t7.*t15.*t30.*4.0;
t127 = pw2.*t2.*t17.*t30.*4.0;
t128 = pw2.*t4.*t17.*t30.*4.0;
t129 = pw3.*t2.*t19.*t30.*4.0;
t130 = pw2.*t10.*t17.*t30.*4.0;
t131 = pw3.*t7.*t19.*t30.*4.0;
t132 = pw3.*t10.*t19.*t30.*4.0;
t133 = pw4.*t4.*t21.*t30.*4.0;
t134 = pw4.*t7.*t21.*t30.*4.0;
t135 = pw4.*t10.*t21.*t30.*4.0;
t144 = pw1.*t2.*t4.*t30.*w1.*2.0;
t145 = pw1.*t2.*t7.*t30.*w1.*2.0;
t146 = pw1.*t4.*t7.*t30.*w1.*2.0;
t147 = pw2.*t2.*t4.*t30.*w2.*2.0;
t148 = pw2.*t2.*t10.*t30.*w2.*2.0;
t149 = pw2.*t4.*t10.*t30.*w2.*2.0;
t150 = pw3.*t2.*t7.*t30.*w3.*2.0;
t151 = pw3.*t2.*t10.*t30.*w3.*2.0;
t152 = pw3.*t7.*t10.*t30.*w3.*2.0;
t153 = pw4.*t4.*t7.*t30.*w4.*2.0;
t154 = pw4.*t4.*t10.*t30.*w4.*2.0;
t155 = pw4.*t7.*t10.*t30.*w4.*2.0;
t200 = pw1.*t14.*t30.*u1.*u4.*w4.*8.0;
t201 = pw1.*t14.*t30.*u2.*u4.*w3.*8.0;
t202 = pw1.*t14.*t30.*u3.*u4.*w2.*8.0;
t203 = pw2.*t16.*t30.*u1.*u3.*w4.*8.0;
t204 = pw2.*t16.*t30.*u2.*u3.*w3.*8.0;
t205 = pw2.*t16.*t30.*u3.*u4.*w1.*8.0;
t206 = pw3.*t18.*t30.*u1.*u2.*w4.*8.0;
t207 = pw3.*t18.*t30.*u2.*u3.*w2.*8.0;
t208 = pw3.*t18.*t30.*u2.*u4.*w1.*8.0;
t209 = pw4.*t20.*t30.*u1.*u2.*w3.*8.0;
t210 = pw4.*t20.*t30.*u1.*u3.*w2.*8.0;
t211 = pw4.*t20.*t30.*u1.*u4.*w1.*8.0;
t39 = pw1.*t5.*t30.*w1;
t40 = pw1.*t8.*t30.*w1;
t41 = pw1.*t11.*t30.*w1;
t42 = pw2.*t5.*t30.*w2;
t43 = pw2.*t8.*t30.*w2;
t44 = pw3.*t5.*t30.*w3;
t45 = pw2.*t13.*t30.*w2;
t46 = pw3.*t11.*t30.*w3;
t47 = pw3.*t13.*t30.*w3;
t48 = pw4.*t8.*t30.*w4;
t49 = pw4.*t11.*t30.*w4;
t50 = pw4.*t13.*t30.*w4;
t136 = -t52;
t137 = -t55;
t138 = -t57;
t139 = -t60;
t140 = -t65;
t141 = -t68;
t142 = -t70;
t143 = -t73;
t156 = pw1.*t2.*t26.*t30.*w1;
t157 = pw1.*t2.*t28.*t30.*w1;
t158 = pw1.*t4.*t26.*t30.*w1;
t159 = pw2.*t2.*t24.*t30.*w2;
t160 = pw2.*t4.*t24.*t30.*w2;
t161 = pw1.*t4.*t29.*t30.*w1;
t162 = pw1.*t7.*t28.*t30.*w1;
t163 = pw1.*t10.*t26.*t30.*w1;
t164 = pw2.*t2.*t28.*t30.*w2;
t165 = pw2.*t7.*t24.*t30.*w2;
t166 = pw3.*t2.*t24.*t30.*w3;
t167 = pw1.*t7.*t29.*t30.*w1;
t168 = pw1.*t10.*t28.*t30.*w1;
t169 = pw3.*t2.*t26.*t30.*w3;
t170 = pw3.*t4.*t24.*t30.*w3;
t171 = pw1.*t10.*t29.*t30.*w1;
t172 = pw2.*t4.*t29.*t30.*w2;
t173 = pw2.*t7.*t28.*t30.*w2;
t174 = pw3.*t4.*t26.*t30.*w3;
t175 = pw3.*t7.*t24.*t30.*w3;
t176 = pw4.*t2.*t24.*t30.*w4;
t177 = pw2.*t7.*t29.*t30.*w2;
t178 = pw2.*t10.*t28.*t30.*w2;
t179 = pw4.*t2.*t26.*t30.*w4;
t180 = pw4.*t4.*t24.*t30.*w4;
t181 = pw2.*t10.*t29.*t30.*w2;
t182 = pw3.*t4.*t29.*t30.*w3;
t183 = pw3.*t10.*t26.*t30.*w3;
t184 = pw4.*t2.*t28.*t30.*w4;
t185 = pw4.*t4.*t26.*t30.*w4;
t186 = pw4.*t7.*t24.*t30.*w4;
t187 = pw3.*t7.*t29.*t30.*w3;
t188 = pw3.*t10.*t29.*t30.*w3;
t189 = pw4.*t7.*t28.*t30.*w4;
t190 = pw4.*t10.*t26.*t30.*w4;
t191 = pw4.*t10.*t28.*t30.*w4;
t192 = -t75;
t193 = -t80;
t194 = -t83;
t195 = -t85;
t196 = -t88;
t197 = -t90;
t198 = -t93;
t199 = -t98;
t212 = -t113;
t213 = -t117;
t214 = -t118;
t215 = -t122;
t216 = 1.0./t99;
t218 = -t201;
t219 = -t203;
t220 = -t208;
t221 = -t210;
t222 = t24+t26+t28+t29+t99;
t224 = t14+t16+t18+t20+t33+t35+t37+t38;
t225 = t22+t23+t25+t27+t31+t32+t34+t36;
t217 = t216.^2;
t223 = sqrt(t222);
t226 = t39+t40+t41+t42+t43+t44+t45+t46+t47+t48+t49+t50+t51+t53+t54+t56+t58+t59+t61+t62+t63+t64+t66+t67+t69+t71+t72+t74+t76+t77+t78+t79+t81+t82+t84+t86+t87+t89+t91+t92+t94+t95+t96+t97+t100+t101+t102+t103+t104+t105+t106+t107+t108+t109+t110+t111+t112+t114+t115+t116+t119+t120+t121+t123+t124+t125+t126+t127+t128+t129+t130+t131+t132+t133+t134+t135+t136+t137+t138+t139+t140+t141+t142+t143+t144+t145+t146+t147+t148+t149+t150+t151+t152+t153+t154+t155+t156+t157+t158+t159+t160+t161+t162+t163+t164+t165+t166+t167+t168+t169+t170+t171+t172+t173+t174+t175+t176+t177+t178+t179+t180+t181+t182+t183+t184+t185+t186+t187+t188+t189+t190+t191+t192+t193+t194+t195+t196+t197+t198+t199+t200+t202+t204+t205+t206+t207+t209+t211+t212+t213+t214+t215+t218+t219+t220+t221;
et1 = pw1.*t5.*t30+pw1.*t8.*t30+pw1.*t11.*t30+pw1.*t2.*t4.*t30.*2.0+pw1.*t2.*t7.*t30.*2.0+pw1.*t4.*t7.*t30.*2.0+pw1.*t2.*t10.*t30+pw1.*t4.*t10.*t30+pw1.*t7.*t10.*t30+pw1.*t2.*t24.*t30+pw1.*t4.*t24.*t30+pw1.*t7.*t24.*t30+pw4.*t3.*t30.*u4-pw3.*t6.*t30.*u4+pw2.*t9.*t30.*u4+pw2.*t12.*t30.*u3-pw3.*t12.*t30.*u2+pw4.*t12.*t30.*u1+pw2.*t2.*t30.*u3.*u4-pw3.*t2.*t30.*u2.*u4+pw2.*t4.*t30.*u3.*u4+pw4.*t4.*t30.*u1.*u4-pw3.*t7.*t30.*u2.*u4+pw4.*t7.*t30.*u1.*u4-pw3.*t18.*t30.*u2.*u4.*4.0+pw2.*t26.*t30.*u3.*u4+pw4.*t29.*t30.*u1.*u4+pw2.*t2.*t30.*w1.*w2.*4.0+pw2.*t4.*t30.*w1.*w2.*4.0+pw3.*t2.*t30.*w1.*w3.*4.0+pw3.*t4.*t30.*w1.*w3.*4.0+pw4.*t2.*t30.*w1.*w4.*4.0+pw2.*t7.*t30.*w1.*w2.*4.0;
et2 = pw4.*t4.*t30.*w1.*w4.*4.0+pw3.*t7.*t30.*w1.*w3.*4.0+pw4.*t7.*t30.*w1.*w4.*4.0+pw1.*t30.*u1.*u4.*w1.*w4.*4.0-pw1.*t30.*u2.*u4.*w1.*w3.*4.0+pw1.*t30.*u3.*u4.*w1.*w2.*4.0+pw2.*t30.*u1.*u4.*w2.*w4.*4.0-pw2.*t30.*u2.*u4.*w2.*w3.*4.0+pw3.*t30.*u1.*u4.*w3.*w4.*4.0+pw3.*t30.*u3.*u4.*w2.*w3.*4.0-pw4.*t30.*u2.*u4.*w3.*w4.*4.0+pw4.*t30.*u3.*u4.*w2.*w4.*4.0;
et3 = pw2.*t5.*t30+pw2.*t8.*t30+pw2.*t13.*t30+pw2.*t2.*t4.*t30.*2.0+pw2.*t2.*t7.*t30+pw2.*t4.*t7.*t30+pw2.*t2.*t10.*t30.*2.0+pw2.*t4.*t10.*t30.*2.0+pw2.*t7.*t10.*t30+pw2.*t2.*t26.*t30+pw2.*t4.*t26.*t30+pw2.*t10.*t26.*t30-pw4.*t3.*t30.*u3+pw3.*t6.*t30.*u3+pw1.*t9.*t30.*u4+pw3.*t9.*t30.*u2-pw4.*t9.*t30.*u1+pw1.*t12.*t30.*u3+pw1.*t2.*t30.*u3.*u4+pw3.*t2.*t30.*u2.*u3+pw1.*t4.*t30.*u3.*u4-pw4.*t4.*t30.*u1.*u3+pw3.*t10.*t30.*u2.*u3-pw4.*t10.*t30.*u1.*u3-pw4.*t20.*t30.*u1.*u3.*4.0+pw1.*t24.*t30.*u3.*u4+pw3.*t28.*t30.*u2.*u3+pw1.*t2.*t30.*w1.*w2.*4.0+pw1.*t4.*t30.*w1.*w2.*4.0+pw3.*t2.*t30.*w2.*w3.*4.0+pw3.*t4.*t30.*w2.*w3.*4.0+pw4.*t2.*t30.*w2.*w4.*4.0+pw1.*t10.*t30.*w1.*w2.*4.0;
et4 = pw4.*t4.*t30.*w2.*w4.*4.0+pw3.*t10.*t30.*w2.*w3.*4.0+pw4.*t10.*t30.*w2.*w4.*4.0-pw1.*t30.*u1.*u3.*w1.*w4.*4.0+pw1.*t30.*u2.*u3.*w1.*w3.*4.0-pw2.*t30.*u1.*u3.*w2.*w4.*4.0+pw2.*t30.*u2.*u3.*w2.*w3.*4.0+pw2.*t30.*u3.*u4.*w1.*w2.*4.0-pw3.*t30.*u1.*u3.*w3.*w4.*4.0+pw3.*t30.*u3.*u4.*w1.*w3.*4.0+pw4.*t30.*u2.*u3.*w3.*w4.*4.0+pw4.*t30.*u3.*u4.*w1.*w4.*4.0;
et5 = pw3.*t5.*t30+pw3.*t11.*t30+pw3.*t13.*t30+pw3.*t2.*t4.*t30+pw3.*t2.*t7.*t30.*2.0+pw3.*t4.*t7.*t30+pw3.*t2.*t10.*t30.*2.0+pw3.*t4.*t10.*t30+pw3.*t7.*t10.*t30.*2.0+pw3.*t2.*t28.*t30+pw3.*t7.*t28.*t30+pw3.*t10.*t28.*t30+pw4.*t3.*t30.*u2-pw1.*t6.*t30.*u4+pw2.*t6.*t30.*u3+pw4.*t6.*t30.*u1+pw2.*t9.*t30.*u2-pw1.*t12.*t30.*u2-pw1.*t2.*t30.*u2.*u4+pw2.*t2.*t30.*u2.*u3-pw1.*t7.*t30.*u2.*u4+pw4.*t7.*t30.*u1.*u2+pw2.*t10.*t30.*u2.*u3+pw4.*t10.*t30.*u1.*u2-pw1.*t14.*t30.*u2.*u4.*4.0+pw2.*t26.*t30.*u2.*u3+pw4.*t29.*t30.*u1.*u2+pw1.*t2.*t30.*w1.*w3.*4.0+pw2.*t2.*t30.*w2.*w3.*4.0+pw1.*t7.*t30.*w1.*w3.*4.0+pw4.*t2.*t30.*w3.*w4.*4.0+pw2.*t7.*t30.*w2.*w3.*4.0+pw1.*t10.*t30.*w1.*w3.*4.0;
et6 = pw2.*t10.*t30.*w2.*w3.*4.0+pw4.*t7.*t30.*w3.*w4.*4.0+pw4.*t10.*t30.*w3.*w4.*4.0+pw1.*t30.*u1.*u2.*w1.*w4.*4.0+pw1.*t30.*u2.*u3.*w1.*w2.*4.0+pw2.*t30.*u1.*u2.*w2.*w4.*4.0-pw2.*t30.*u2.*u4.*w1.*w2.*4.0+pw3.*t30.*u1.*u2.*w3.*w4.*4.0+pw3.*t30.*u2.*u3.*w2.*w3.*4.0-pw3.*t30.*u2.*u4.*w1.*w3.*4.0+pw4.*t30.*u2.*u3.*w2.*w4.*4.0-pw4.*t30.*u2.*u4.*w1.*w4.*4.0;
et7 = pw4.*t8.*t30+pw4.*t11.*t30+pw4.*t13.*t30+pw4.*t2.*t4.*t30+pw4.*t2.*t7.*t30+pw4.*t4.*t7.*t30.*2.0+pw4.*t2.*t10.*t30+pw4.*t4.*t10.*t30.*2.0+pw4.*t7.*t10.*t30.*2.0+pw4.*t4.*t29.*t30+pw4.*t7.*t29.*t30+pw4.*t10.*t29.*t30+pw1.*t3.*t30.*u4-pw2.*t3.*t30.*u3+pw3.*t3.*t30.*u2+pw3.*t6.*t30.*u1-pw2.*t9.*t30.*u1+pw1.*t12.*t30.*u1+pw1.*t4.*t30.*u1.*u4-pw2.*t4.*t30.*u1.*u3+pw1.*t7.*t30.*u1.*u4+pw3.*t7.*t30.*u1.*u2-pw2.*t10.*t30.*u1.*u3+pw3.*t10.*t30.*u1.*u2-pw2.*t16.*t30.*u1.*u3.*4.0+pw1.*t24.*t30.*u1.*u4+pw3.*t28.*t30.*u1.*u2+pw1.*t4.*t30.*w1.*w4.*4.0+pw2.*t4.*t30.*w2.*w4.*4.0+pw1.*t7.*t30.*w1.*w4.*4.0+pw3.*t4.*t30.*w3.*w4.*4.0+pw2.*t7.*t30.*w2.*w4.*4.0+pw1.*t10.*t30.*w1.*w4.*4.0;
et8 = pw3.*t7.*t30.*w3.*w4.*4.0+pw2.*t10.*t30.*w2.*w4.*4.0+pw3.*t10.*t30.*w3.*w4.*4.0+pw1.*t30.*u1.*u2.*w1.*w3.*4.0-pw1.*t30.*u1.*u3.*w1.*w2.*4.0+pw2.*t30.*u1.*u2.*w2.*w3.*4.0+pw2.*t30.*u1.*u4.*w1.*w2.*4.0-pw3.*t30.*u1.*u3.*w2.*w3.*4.0+pw3.*t30.*u1.*u4.*w1.*w3.*4.0+pw4.*t30.*u1.*u2.*w3.*w4.*4.0-pw4.*t30.*u1.*u3.*w2.*w4.*4.0+pw4.*t30.*u1.*u4.*w1.*w4.*4.0;
et9 = (t217.*t222.*(pw1.*t3-pw2.*t6-pw3.*t9+pw4.*t12+pw1.*t4.*u1-pw2.*t2.*u2-pw3.*t2.*u3+pw1.*t7.*u1-pw3.*t4.*u3+pw4.*t2.*u4-pw2.*t7.*u2+pw1.*t10.*u1+pw4.*t4.*u4-pw2.*t10.*u2+pw4.*t7.*u4-pw3.*t10.*u3-pw2.*t16.*u2.*4.0-pw3.*t18.*u3.*4.0+pw1.*t24.*u1+pw4.*t29.*u4-pw1.*u2.*w1.*w2.*4.0+pw2.*u1.*w1.*w2.*4.0-pw1.*u3.*w1.*w3.*4.0+pw3.*u1.*w1.*w3.*4.0+pw1.*u4.*w1.*w4.*4.0-pw2.*u3.*w2.*w3.*4.0-pw3.*u2.*w2.*w3.*4.0+pw4.*u1.*w1.*w4.*4.0+pw2.*u4.*w2.*w4.*4.0-pw4.*u2.*w2.*w4.*4.0+pw3.*u4.*w3.*w4.*4.0-pw4.*u3.*w3.*w4.*4.0).^2)./8.0;
et10 = (t217.*t222.*(pw2.*t3+pw1.*t6-pw4.*t9-pw3.*t12+pw1.*t2.*u2+pw2.*t4.*u1-pw3.*t2.*u4-pw4.*t2.*u3+pw1.*t7.*u2+pw2.*t7.*u1-pw3.*t4.*u4-pw4.*t4.*u3+pw1.*t10.*u2+pw2.*t10.*u1-pw3.*t7.*u4-pw4.*t10.*u3-pw3.*t18.*u4.*4.0+pw1.*t24.*u2-pw4.*t20.*u3.*4.0+pw2.*t26.*u1+pw1.*u1.*w1.*w2.*4.0+pw2.*u2.*w1.*w2.*4.0-pw1.*u3.*w1.*w4.*4.0-pw1.*u4.*w1.*w3.*4.0+pw3.*u1.*w2.*w3.*4.0+pw3.*u2.*w1.*w3.*4.0-pw2.*u3.*w2.*w4.*4.0-pw2.*u4.*w2.*w3.*4.0+pw4.*u1.*w2.*w4.*4.0+pw4.*u2.*w1.*w4.*4.0-pw3.*u3.*w3.*w4.*4.0-pw4.*u4.*w3.*w4.*4.0).^2)./8.0;
et11 = (t217.*t222.*(pw3.*t3+pw1.*t9+pw4.*t6+pw2.*t12+pw1.*t2.*u3+pw1.*t4.*u3+pw2.*t2.*u4+pw3.*t4.*u1+pw4.*t2.*u2+pw2.*t4.*u4+pw3.*t7.*u1+pw2.*t7.*u4+pw4.*t7.*u2+pw1.*t10.*u3+pw3.*t10.*u1+pw4.*t10.*u2+pw1.*t24.*u3+pw2.*t26.*u4+pw3.*t28.*u1+pw4.*t29.*u2+pw1.*u1.*w1.*w3.*4.0+pw1.*u2.*w1.*w4.*4.0+pw1.*u4.*w1.*w2.*4.0+pw2.*u1.*w2.*w3.*4.0+pw2.*u3.*w1.*w2.*4.0+pw2.*u2.*w2.*w4.*4.0+pw3.*u3.*w1.*w3.*4.0+pw3.*u2.*w3.*w4.*4.0+pw3.*u4.*w2.*w3.*4.0+pw4.*u1.*w3.*w4.*4.0+pw4.*u3.*w1.*w4.*4.0+pw4.*u4.*w2.*w4.*4.0).^2)./8.0;
H_opt = (t30.*t216.*(pw1.*(u1.*(-1.0./4.0)+(t223.*t224.*(et1+et2))./4.0+(t216.*t223.*t225.*t226.*w1)./2.0)+pw2.*(u2.*(-1.0./4.0)+(t223.*t224.*(et3+et4))./4.0+(t216.*t223.*t225.*t226.*w2)./2.0)+pw3.*(u3.*(-1.0./4.0)+(t223.*t224.*(et5+et6))./4.0+(t216.*t223.*t225.*t226.*w3)./2.0)+pw4.*(u4.*(-1.0./4.0)+(t223.*t224.*(et7+et8))./4.0+(t216.*t223.*t225.*t226.*w4)./2.0)+pu1.*w1+pu2.*w2+pu3.*w3+pu4.*w4-(t30.*t99.*t223.*(et9+et10+et11))./4.0))./t223;
